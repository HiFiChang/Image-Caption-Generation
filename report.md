# 图像描述生成实验报告

常皓飞 2023202311 

> 现已开源：https://github.com/HiFiChang/Image-Caption-Generation



## 数据处理

1. 将一个image多个caption的情况拆分成多条样本
2. 图像变换成张量 [3, 224, 224]，进行normalize以匹配预训练的encoder的格式
3. caption截断/填充到50定长 [50]，是vocabulary的索引



## 模型结构

### Encoder

#### ResNET



#### ViT



### Decoder






## 实验结果与分析

| Encoder   | Decoder     |   BLEU-1   |   BLEU-2   |   BLEU-3   |   BLEU-4   |   METEOR   |  ROUGE-L   |   CIDEr    |
| :-------- | :---------- | :--------: | :--------: | :--------: | :--------: | :--------: | :--------: | :--------: |
| ResNet50  | LSTM        |   0.5853   |   0.3988   |   0.2652   |   0.1737   |   0.3883   |   0.4414   |   0.4420   |
| ResNet50  | GRU         |   0.5532   |   0.3758   |   0.2445   |   0.1585   |   0.3787   |   0.4324   |   0.4165   |
| ResNet50  | Transformer |   0.5509   |   0.3713   |   0.2431   |   0.1587   |   0.3838   |   0.4302   |   0.4318   |
| ResNet101 | LSTM        |   0.5707   |   0.3907   |   0.2576   |   0.1677   |   0.3901   |   0.4395   |   0.4438   |
| ResNet101 | GRU         |   0.5866   |   0.4026   |   0.2693   |   0.1785   |   0.3856   |   0.4448   |   0.4441   |
| ResNet101 | Transformer |   0.5827   |   0.3978   |   0.2657   |   0.1775   |   0.3836   |   0.4397   |   0.4680   |
| ViT-B/16  | LSTM        |   0.5832   |   0.4064   | **0.2713** | **0.1805** | **0.3979** | **0.4464** | **0.4880** |
| ViT-B/16  | GRU         | **0.5960** | **0.4105** |   0.2700   |   0.1732   |   0.3876   |   0.4461   |   0.4869   |
| ViT-B/16  | Transformer |   0.5711   |   0.3861   |   0.2515   |   0.1627   |   0.3857   |   0.4364   |   0.4474   |



## 经验总结

Trick

1. 不要微调encoder
